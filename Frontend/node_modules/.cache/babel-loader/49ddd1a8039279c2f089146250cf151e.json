{"ast":null,"code":"import _slicedToArray from\"/media/amine/HDD1/Kraya/2DNI/TP/S2/Framework/Projet/IMessage-Clone/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import'./Chat.css';import MicIcon from'@material-ui/icons/Mic';import{IconButton}from'@material-ui/core';import Message from'./Message';import{useSelector}from'react-redux';import{selectChatId,selectChatName}from'./features/chatSlice';import db from'./Firebase';import firebase from'firebase';import{selectUser}from'./features/userSlice';import FlipMove from'react-flip-move';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function Chat(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];var chatName=useSelector(selectChatName);var chatId=useSelector(selectChatId);var user=useSelector(selectUser);useEffect(function(){if(chatId){db.collection('chats').doc(chatId).collection('messages').orderBy('timestamp','desc').onSnapshot(function(snapshot){return setMessages(snapshot.docs.map(function(doc){return{id:doc.id,data:doc.data()};}));});}},[chatId]);var sendMessage=function sendMessage(e){e.preventDefault();setInput('');// firebase \ndb.collection(\"chats\").doc(chatId).collection(\"messages\").add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),message:input,uid:user.uid,photo:user.photo,email:user.email,displayName:user.displayName});};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat__header\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"To:\",/*#__PURE__*/_jsxs(\"span\",{className:\"chat__name\",children:[\" \",chatName]})]}),/*#__PURE__*/_jsx(\"strong\",{children:\"Details\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat__messages\",children:/*#__PURE__*/_jsx(FlipMove,{children:messages.map(function(_ref){var id=_ref.id,data=_ref.data;return/*#__PURE__*/_jsx(Message,{contents:data},id);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat__input\",children:[/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{value:input,onChange:function onChange(e){return setInput(e.target.value);},placeholder:\"ikteb hneye\",type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,children:\"Send Message\"})]}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(MicIcon,{className:\"chat__mic\"})})]})]});}export default Chat;","map":{"version":3,"sources":["/media/amine/HDD1/Kraya/2DNI/TP/S2/Framework/Projet/IMessage-Clone/src/Chat.js"],"names":["React","useEffect","useState","MicIcon","IconButton","Message","useSelector","selectChatId","selectChatName","db","firebase","selectUser","FlipMove","Chat","input","setInput","messages","setMessages","chatName","chatId","user","collection","doc","orderBy","onSnapshot","snapshot","docs","map","id","data","sendMessage","e","preventDefault","add","timestamp","firestore","FieldValue","serverTimestamp","message","uid","photo","email","displayName","target","value"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport './Chat.css';\nimport MicIcon from '@material-ui/icons/Mic';\nimport { IconButton } from '@material-ui/core';\nimport Message from './Message'\nimport { useSelector } from 'react-redux';\nimport { selectChatId, selectChatName } from './features/chatSlice';\nimport db from './Firebase';\nimport firebase from 'firebase';\nimport { selectUser } from './features/userSlice';\nimport FlipMove from 'react-flip-move';\n\nfunction Chat() {\n\n    const [input, setInput] = useState('');\n    const [messages, setMessages] = useState([]);\n\n    const chatName = useSelector(selectChatName);\n    const chatId = useSelector(selectChatId);\n    const user = useSelector(selectUser);\n\n    useEffect (() => {\n        if (chatId) {\n            db.collection('chats').doc(chatId).collection('messages')\n            .orderBy('timestamp', 'desc')\n            .onSnapshot(snapshot => (\n                setMessages(\n                    snapshot.docs.map((doc) => ({\n                    id: doc.id,\n                    data: doc.data(),\n                })))\n            ))\n        }\n    }, [chatId])\n\n    const sendMessage = (e) => {\n        \n        e.preventDefault();\n        setInput('');\n\n        // firebase \n\n        db.collection(\"chats\").doc(chatId).collection(\"messages\").add({\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n            message: input,\n            uid: user.uid,\n            photo: user.photo,\n            email: user.email,\n            displayName: user.displayName,\n          });\n\n        \n    }\n\n    return (\n        <div className='chat'>\n\n        {/* chat header */}\n            <div className='chat__header'>\n                <h4>To:\n                <span className='chat__name'> {chatName}</span>\n                </h4>\n                <strong>Details</strong>\n            </div>\n        {/* chat messages */}\n\n        <div className='chat__messages'>\n            <FlipMove>\n                {messages.map(({id, data}) => (\n                    <Message key={id} contents={data} />\n                ))}\n            </FlipMove>\n            \n\n        </div>\n\n\n        {/* chat input */}\n            <div className='chat__input'>\n                <form>\n                    \n                    <input \n                        value={input} \n                        onChange={(e) => setInput(e.target.value)} \n                        placeholder='ikteb hneye' type='text'/>\n                        \n                    <button onClick={sendMessage}>Send Message</button>\n                \n                </form>\n\n                <IconButton>\n                    <MicIcon className='chat__mic'/>\n                </IconButton>\n                \n\n            </div>\n        </div>\n    )\n}\n\nexport default Chat\n"]},"metadata":{},"sourceType":"module"}